"""
ゲーム設定・定数定義

役職構成やタイムアウト時間などのゲーム設定を一元管理する。
"""

from game.models import Role

# =============================================================================
# 役職構成（プレイヤー人数ごと）
# =============================================================================
# プレイヤー人数 n に対し、n + 2 枚のカードを使用（プレイヤー用 n 枚 + 中央 2 枚）
#
# バランス考慮のポイント:
# - 3人: 最小構成。人狼1、特殊役職（占い師・怪盗）で情報戦、吊り人で緊張感
# - 4人: 村人を1人追加し、安定した情報戦を可能に
# - 5人: 人狼2人体制で人狼同士の連携が可能に
# - 6人: 村人を増やしつつ、人狼2人体制を維持

ROLE_CONFIG: dict[int, list[Role]] = {
    # 3人プレイ: 5枚 (3人 + 中央2枚)
    # 村人1, 人狼1, 占い師1, 怪盗1, 吊り人1
    3: [
        Role.VILLAGER,
        Role.WEREWOLF,
        Role.SEER,
        Role.THIEF,
        Role.TANNER,
    ],
    
    # 4人プレイ: 6枚 (4人 + 中央2枚)
    # 村人2, 人狼1, 占い師1, 怪盗1, 吊り人1
    4: [
        Role.VILLAGER,
        Role.VILLAGER,
        Role.WEREWOLF,
        Role.SEER,
        Role.THIEF,
        Role.TANNER,
    ],
    
    # 5人プレイ: 7枚 (5人 + 中央2枚)
    # 村人2, 人狼2, 占い師1, 怪盗1, 吊り人1
    5: [
        Role.VILLAGER,
        Role.VILLAGER,
        Role.WEREWOLF,
        Role.WEREWOLF,
        Role.SEER,
        Role.THIEF,
        Role.TANNER,
    ],
    
    # 6人プレイ: 8枚 (6人 + 中央2枚)
    # 村人3, 人狼2, 占い師1, 怪盗1, 吊り人1
    6: [
        Role.VILLAGER,
        Role.VILLAGER,
        Role.VILLAGER,
        Role.WEREWOLF,
        Role.WEREWOLF,
        Role.SEER,
        Role.THIEF,
        Role.TANNER,
    ],
}

# =============================================================================
# ゲーム設定
# =============================================================================

# プレイヤー人数の制限
MIN_PLAYERS = 3
MAX_PLAYERS = 6

# 中央カードの枚数（常に2枚）
CENTER_CARD_COUNT = 2

# =============================================================================
# タイムアウト設定（秒）
# =============================================================================

# 夜フェーズで各役職が行動を選択するまでの制限時間
NIGHT_ACTION_TIMEOUT = 60

# 昼フェーズの議論時間
DISCUSSION_TIME = 180  # 3分

# 投票の制限時間
VOTE_TIMEOUT = 60

# =============================================================================
# メッセージテンプレート
# =============================================================================

MESSAGES = {
    # ゲーム開始関連
    "game_started": "🐺 **ワンナイト人狼** の参加者を募集中！\n`/onenight join` で参加してください。\n現在の参加者: {count}人",
    "player_joined": "✅ {player} さんが参加しました！（現在 {count}人）",
    "player_left": "❌ {player} さんが離脱しました。（現在 {count}人）",
    "game_begin": "🌙 ゲームを開始します！各プレイヤーにDMで役職を通知します...",
    
    # 役職通知
    "role_notification": "🎭 あなたの役職は **{role}** です。\n\n{description}",
    
    # 夜フェーズ
    "night_start": "🌙 **夜になりました...**\n各役職は順番に行動します。DMをご確認ください。",
    "werewolf_alone": "🐺 あなたは唯一の人狼です。他に人狼はいません。",
    "werewolf_partners": "🐺 他の人狼: {partners}",
    "seer_prompt": "🔮 占い師の行動を選んでください：\n• `!seer player @プレイヤー` - 他プレイヤーの役職を見る\n• `!seer center` - 中央カード2枚を見る",
    "thief_prompt": "🦹 怪盗の行動を選んでください：\n• `!thief @プレイヤー` - そのプレイヤーとカードを交換する\n• `!thief skip` - 何もしない",
    
    # 昼フェーズ
    "day_start": "☀️ **朝になりました！**\n{time}秒間、自由に議論してください。\n議論終了後、投票フェーズに移ります。",
    "vote_start": "🗳️ **投票フェーズです！**\n`/onenight vote @プレイヤー` で投票してください。\n※自分以外のプレイヤーに投票できます。",
    "vote_received": "✅ {player} さんが投票しました。（{voted}/{total}）",
    
    # 結果発表
    "execution_result": "⚖️ **処刑結果**\n{result}",
    "game_result": "🏆 **ゲーム結果**\n{result}\n\n**勝者**: {winners}",
    "final_roles": "📋 **最終役職**\n{roles}",
    
    # エラー・警告
    "game_already_running": "⚠️ このチャンネルでは既にゲームが進行中です。",
    "not_in_game": "⚠️ ゲームに参加していません。",
    "already_joined": "⚠️ 既にゲームに参加しています。",
    "not_enough_players": "⚠️ プレイヤーが足りません。（最低{min}人必要、現在{current}人）",
    "too_many_players": "⚠️ プレイヤーが多すぎます。（最大{max}人まで）",
    "not_host": "⚠️ このコマンドはホスト（ゲーム開始者）のみ実行できます。",
    "wrong_phase": "⚠️ 現在このコマンドは使用できません。",
    "invalid_target": "⚠️ 無効な対象です。",
    "cannot_vote_self": "⚠️ 自分自身には投票できません。",
    "already_voted": "⚠️ 既に投票済みです。",
}

# =============================================================================
# 役職の説明文
# =============================================================================

ROLE_DESCRIPTIONS = {
    Role.VILLAGER: "特別な能力はありません。議論で人狼を見つけ出しましょう。",
    Role.WEREWOLF: "人狼陣営です。バレないように村人を欺きましょう。",
    Role.SEER: "夜に他プレイヤー1人の役職か、中央カード2枚を見ることができます。",
    Role.THIEF: "夜に他プレイヤー1人とカードを交換できます。交換後の役職があなたの最終役職になります。",
    Role.TANNER: "処刑されることが目的です。自分が処刑されれば単独勝利！",
}

